(this.webpackJsonpforms=this.webpackJsonpforms||[]).push([[0],{139:function(e,t,a){e.exports=a(181)},144:function(e,t,a){},145:function(e,t,a){},166:function(e,t,a){},173:function(e,t,a){},181:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(14),s=a.n(o),c=(a(144),a(74)),l=(a(145),a(64)),i=a(22),u=a.n(i),m=a(30),d=a(40),p=a(58),h=a.n(p),g=a(66),f=a(249),b=a(26),v=a(122);var w={init:function(){f.a({dsn:"https://ce625a42c479474d86a00952b0109351@o504500.ingest.sentry.io/5591499",autoSessionTracking:!0,integrations:[new v.a.BrowserTracing],tracesSampleRate:1})},log:function(e){b.a(e)}};h.a.interceptors.response.use(null,(function(e){return e.response&&e.response.status>=400&&e.response.status<500||(w.log(e),console.log("some other unexp error",e),g.b.error("unexpected error occured")),Promise.reject(e)}));var E={get:h.a.get,post:h.a.post,put:h.a.put,delete:h.a.delete,setJwt:function(e){h.a.defaults.headers.common["x-auth-token"]=e}},C=a(115),k=a(44),S=k.apiUrl+"/auth";function j(){return(j=Object(m.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.post(S,{email:t.email,password:t.password});case 2:a=e.sent,n=a.data,localStorage.setItem("token",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return localStorage.getItem("token")}E.setJwt(O());var x={login:function(e){return j.apply(this,arguments)},loginWithJwt:function(e){localStorage.setItem("token",e)},logout:function(){localStorage.removeItem("token")},getCurrentUser:function(){try{var e=localStorage.getItem("token");return Object(C.a)(e)}catch(t){return null}},getJwt:O},y=k.apiUrl+"/users";var D=a(18),I=(a(166),a(182)),N=a(253),B=a(239),L=a(251),U=a(235),P=a(255),T=a(240),J=a(231),_=Object(J.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}})),A=function(e){var t=_(),a=Object(n.useState)({email:"",name:"",password:"",rePassword:"",selectedTab:0,warning:""}),o=Object(c.a)(a,2),s=o[0],i=o[1],p=r.a.useState(!1),h=Object(c.a)(p,2),f=h[0],b=h[1],v=(k.api_url,function(){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(s.email)?"":"Invalid email"}),w=function(){var t=Object(m.a)(u.a.mark((function t(a){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),n="",n=0===s.email.length?"Please enter an email id":v(),0===s.password.length&&(n+="\n Please enter your password"),0===n.length){t.next=7;break}return alert(n),t.abrupt("return");case 7:return t.prev=7,b(!0),t.next=11,x.login(s);case 11:e.updateUser(),t.next=19;break;case 14:return t.prev=14,t.t0=t.catch(7),b(!1),t.t0.response&&400===t.t0.response.status&&g.b.error(t.t0.response.data),t.abrupt("return");case 19:if(0===n.length){t.next=22;break}return alert(n),t.abrupt("return");case 22:b(!1),e.history.push("/customers");case 24:case"end":return t.stop()}}),t,null,[[7,14]])})));return function(e){return t.apply(this,arguments)}}(),C=function(){var t=Object(m.a)(u.a.mark((function t(){var a,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a="",a=0===s.email.length?"Please enter an email id":v(),0===s.password.length?a+="\nPlease enter a password":s.password!==s.rePassword&&(a+="\nPasswords don't match"),0===a.trim().length){t.next=6;break}return alert(a),t.abrupt("return");case 6:return t.prev=6,b(!0),t.next=10,r=s,E.post(y,{email:r.email,password:r.password,name:r.name});case 10:n=t.sent,x.loginWithJwt(n.headers["x-auth-token"]),e.updateUser(),b(!1),e.history.push("/customers"),t.next=22;break;case 17:return t.prev=17,t.t0=t.catch(6),b(!1),t.t0.response&&400===t.t0.response.status&&g.b.error(t.t0.response.data),t.abrupt("return");case 22:0===a.length&&i(Object(d.a)(Object(d.a)({},s),{},{selectedTab:0}));case 23:case"end":return t.stop()}var r}),t,null,[[6,17]])})));return function(){return t.apply(this,arguments)}}(),S=function(e){i(Object(d.a)(Object(d.a)({},s),{},Object(l.a)({},e.target.name,e.target.value)))},j=function(e){var t;i(Object(d.a)(Object(d.a)({},s),{},{selectedTab:e})),t={selectedTab:e},i(Object(d.a)(Object(d.a)({},s),{},{email:"",name:"",password:"",rePassword:"",warning:""},t))};return x.getCurrentUser()?r.a.createElement(D.a,{to:"/customers"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,null),r.a.createElement("div",{className:"crmHome-main"},r.a.createElement("div",{className:"crmHome-title"},"Best CRM App"),r.a.createElement(I.a,{className:"paperForm"},r.a.createElement(L.a,{value:s.selectedTab,onChange:function(e,t){return j(t)},"aria-label":"simple tabs example"},r.a.createElement(U.a,{label:"LOGIN"}),r.a.createElement(U.a,{label:"SIGN UP"})),r.a.createElement("div",{className:"loginView tabView",hidden:1===s.selectedTab},r.a.createElement(N.a,{name:"email",id:"logIn-email",label:"email",variant:"outlined",onChange:S,value:s.email}),r.a.createElement(N.a,{name:"password",id:"logIn-password",label:"password",variant:"outlined",type:"password",onChange:S,value:s.password}),r.a.createElement(B.a,{color:"primary",variant:"contained",onClick:function(e){return w(e)}},"log in")),r.a.createElement("div",{className:"signupView tabView",hidden:0===s.selectedTab},r.a.createElement(N.a,{name:"name",id:"signup-name",label:"name",variant:"outlined",onChange:S,value:s.name}),r.a.createElement(N.a,{name:"email",id:"signUp-email",label:"email",variant:"outlined",onChange:S,value:s.email}),r.a.createElement(N.a,{name:"password",id:"signUp-password",label:"password",variant:"outlined",type:"password",onChange:S,value:s.password}),r.a.createElement(N.a,{name:"rePassword",id:"signUp-rePassword",label:"password",variant:"outlined",type:"password",onChange:S,value:s.rePassword}),r.a.createElement(B.a,{color:"primary",variant:"contained",onClick:function(){return C()}},"Sign Up")))),r.a.createElement(P.a,{className:t.backdrop,open:f},r.a.createElement(T.a,{color:"inherit"})))},M=a(124),W=function(e){e.path;var t=e.component,a=e.render,n=Object(M.a)(e,["path","component","render"]);return r.a.createElement(D.b,Object.assign({exact:!0},n,{render:function(e){return x.getCurrentUser()?t?r.a.createElement(t,e):a(e):r.a.createElement(D.a,{to:{pathname:"/",state:{from:e.location}}})}}))},z=a(119),F=a(120),V=a(125),G=a(123),H=(a(173),a(250)),R=a(256),$=a(242),q=a(246),K=a(245),Q=a(241),X=a(243),Y=a(244),Z=a(121),ee=a.n(Z),te=Object(J.a)({table:{minWidth:650}});function ae(e){var t=te();return r.a.createElement(Q.a,{component:I.a},r.a.createElement($.a,{className:t.table,"aria-label":"simple table"},r.a.createElement(X.a,null,r.a.createElement(Y.a,null,r.a.createElement(K.a,null,"Customer ID"),r.a.createElement(K.a,{align:"right"},"Name"),r.a.createElement(K.a,{align:"right"},"Gender"),r.a.createElement(K.a,{align:"right"},"Contact No"),r.a.createElement(K.a,{align:"right"},"Remove?"))),r.a.createElement(q.a,null,e.tableData.map((function(t,a){return r.a.createElement(Y.a,{key:t.name},r.a.createElement(K.a,{component:"th",scope:"row"},t._id),r.a.createElement(K.a,{align:"right"},t.name),r.a.createElement(K.a,{align:"right"},t.gender),r.a.createElement(K.a,{align:"right"},t.contact),r.a.createElement(K.a,{align:"right"},e.deletingCustList.includes(t._id)?r.a.createElement("div",null,r.a.createElement(T.a,{color:"secondary"})):r.a.createElement(B.a,{variant:"contained",color:"secondary",className:"deleteBtn",startIcon:r.a.createElement(ee.a,null),onClick:function(){e.deleteCustomerId(t._id,a)}})))})))))}var ne=a(254),re=a(252),oe=k.apiUrl+"/customers";function se(e){return E.delete((t=e,"".concat(oe,"/").concat(t)));var t}var ce=a(178),le=function(e){Object(V.a)(a,e);var t=Object(G.a)(a);function a(e){var n;return Object(z.a)(this,a),(n=t.call(this,e)).state={name:"",gender:"male",contact:"",fetchedData:"",tableData:[],deletingCustList:[],openSnackBar:!1,lastDeletedCustomer:{},showUndoIndicator:!1},n.errorBoolsList=[!1,!1],n.setErrorsList=function(e){console.log("errorList is:"+e),n.errorBoolsList=[].concat(e)},n.showSnackBar=function(){n.setState({openSnackBar:!0})},n.closeSnackBar=function(e,t){"clickaway"!==t&&n.setState({openSnackBar:!1})},n.createData=function(e,t,a,n){return{_id:e,name:t,gender:a,contact:n}},n.deleteCustomerId=function(){var e=Object(m.a)(u.a.mark((function e(t,a){var r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r={}).data=n.state.tableData[a],r.index=a,n.setState({deletingCustList:n.state.deletingCustList.concat(t)}),console.log("deleting custID:"+t),e.next=7,se(t);case 7:o=e.sent,console.log("customer deleted, resp.data is ",o.data),n.setState({tableData:n.state.tableData.filter((function(e){return e._id!==t})),deletingCustList:n.state.deletingCustList.filter((function(e){return e!==t}))}),console.log("main list, deleting id list and last cust deleting list updated using setState, showing snackbar now"+t),n.showSnackBar();case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.validateData=function(){var e=[!1,!1],t=[];return 0===n.state.name.length&&(t.push("Customer Name can't be empty"),e[0]=!0),0===n.state.contact.length&&(t.push("Contact number can't be empty"),e[1]=!0),isNaN(n.state.contact)&&(t.push("Please enter valid mob number"),e[1]=!0),10!=="".concat(parseInt(n.state.contact)).length&&(t.push("Contact Number needs to be of 10 digit"),e[1]=!0),t.length>0&&alert(t.join("\n")),n.setErrorsList(e),n.setState(),0===t.length},n.handleInputChange=function(e){n.setState(Object(l.a)({},e.target.name,e.target.value))},n.genderList=["male","female","others","prefer not to say"],n.updateTableData=function(){var e=Object(m.a)(u.a.mark((function e(t,a,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("position in new function is: and element to be added is "+r,a),void 0===r?t.push(a):t.splice(r,0,a),n.setState({tableData:t||[],lastDeletedCustomer:{}});case 3:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),n.getCustomerIdAndSaveData=Object(m.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.validateData()){e.next=3;break}return n.setState({},(function(){return n.errorBoolsList})),e.abrupt("return",0);case 3:return n.setState({fetchedData:null}),new Map,e.next=7,r=ce.pick(n.state,["name","contact","gender"]),E.post(oe,r);case 7:return t=e.sent,console.log("response from server after adding another customer is ,",t),console.log(n.state),a=[].concat(n.state.tableData),e.next=13,n.updateTableData(a,n.createData(t.data._id,n.state.name,n.state.gender,n.state.contact));case 13:n.setState({customerName:"",gender:"Male",mobNo:"",fetchedData:""},(function(){return n.errorBoolsList}));case 14:case"end":return e.stop()}var r}),e)}))),n.fetchFormData=Object(m.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.get(oe);case 2:t=e.sent,a=t.data,n.setState({tableData:null!==a&&void 0!==a?a:[]});case 5:case"end":return e.stop()}}),e)}))),n}return Object(F.a)(a,[{key:"componentDidMount",value:function(){console.log("mounted"),this.fetchFormData(),console.log("data from local storage")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(I.a,{className:"paper"},r.a.createElement("form",null,r.a.createElement("div",null,r.a.createElement(N.a,{name:"name",id:"customerName",label:"Customer Name",variant:"outlined",onChange:this.handleInputChange,value:this.state.name,error:this.errorBoolsList[0]})),r.a.createElement("div",null,r.a.createElement(N.a,{name:"contact",id:"mobNo",label:"Contact No.",variant:"outlined",onChange:this.handleInputChange,value:this.state.contact,error:this.errorBoolsList[1]})),r.a.createElement("div",null,r.a.createElement(H.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",name:"gender",value:this.state.gender,onChange:this.handleInputChange,color:"secondary"},this.genderList.map((function(e){return r.a.createElement(R.a,{value:e},e)}))))),null===this.state.fetchedData?r.a.createElement("div",null,r.a.createElement(T.a,{color:"secondary"})):r.a.createElement("div",null,r.a.createElement(B.a,{color:"primary",variant:"contained",onClick:function(){return e.getCustomerIdAndSaveData()}},"Save info"),this.state.showUndoIndicator?r.a.createElement("div",null,r.a.createElement(T.a,{color:"secondary"})):"")),0!==this.state.tableData.length?r.a.createElement(ae,{className:"simpleTable",tableData:this.state.tableData,deletingCustList:this.state.deletingCustList,deleteCustomerId:function(t,a){return e.deleteCustomerId(t,a)}}):"",r.a.createElement(ne.a,{open:this.state.openSnackBar,autoHideDuration:3e3,onClose:this.closeSnackBar},r.a.createElement(re.a,{onClose:this.closeSnackBar,severity:"success"},"Customer Deleted!")))}}]),a}(r.a.Component);a(180);function ie(){return Object(n.useEffect)((function(){localStorage.removeItem("token")}),[]),null}var ue=a(247),me=a(248),de=function(e){var t=Object(D.g)();function a(){return(a=Object(m.a)(u.a.mark((function a(){return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:x.logout(),e.updateUser(),t.push("/");case 3:case"end":return a.stop()}}),a)})))).apply(this,arguments)}return r.a.createElement(ue.a,{position:"static",className:"topAppBar"},r.a.createElement(me.a,{className:"appBar-toolBar"},e.user?r.a.createElement(B.a,{color:"inherit",onClick:function(){return a.apply(this,arguments)}},"Logout"):""))};var pe=function(e){var t=Object(n.useState)({}),a=Object(c.a)(t,2),o=a[0],s=a[1],l=function(){var e=x.getCurrentUser();s(e)};return Object(n.useEffect)((function(){l()}),[]),r.a.createElement("div",{className:"App"},r.a.createElement(de,{user:o,updateUser:l}),r.a.createElement("header",{className:"App-header"},r.a.createElement(D.d,null,r.a.createElement(W,{exact:!0,path:"/customers",component:le}),r.a.createElement(D.b,{path:"/",render:function(e){return r.a.createElement(A,Object.assign({},e,{updateUser:l}))}}),r.a.createElement(D.b,{path:"/logout",component:ie}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var he=a(61);w.init(),s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(he.a,null,r.a.createElement(pe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},44:function(e){e.exports=JSON.parse('{"api_url":"https://u39h9e73d2.execute-api.us-east-1.amazonaws.com/production/api","apiUrl":"https://u39h9e73d2.execute-api.us-east-1.amazonaws.com/production/api"}')}},[[139,1,2]]]);
//# sourceMappingURL=main.ad1328b8.chunk.js.map