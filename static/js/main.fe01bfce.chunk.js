(this.webpackJsonpforms=this.webpackJsonpforms||[]).push([[0],{100:function(e,t,a){e.exports=a(143)},105:function(e,t,a){},106:function(e,t,a){},128:function(e,t,a){},135:function(e,t,a){},143:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(9),o=a.n(s),l=(a(105),a(87)),c=(a(106),a(56)),i=a(16),u=a.n(i),m=a(21),d=a(57),p=a(58),h=a(64),g=a(63),f=a(39),v=a.n(f),b=a(44);var w={init:function(){},log:function(e){console.log(e)}};v.a.interceptors.response.use(null,(function(e){return e.response&&e.response.status>=400&&e.response.status<500||(w.log(e),console.log("some other unexp error",e),b.b.error("unexpected error occured")),Promise.reject(e)}));var E={get:v.a.get,post:v.a.post,put:v.a.put,delete:v.a.delete,setJwt:function(e){v.a.defaults.headers.common["x-auth-token"]=e}},C=a(82),k=a(30),S=k.apiUrl+"/auth";function I(){return(I=Object(m.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.post(S,{email:t.email,password:t.password});case 2:a=e.sent,n=a.data,localStorage.setItem("token",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return localStorage.getItem("token")}E.setJwt(y());var x={login:function(e){return I.apply(this,arguments)},loginWithJwt:function(e){localStorage.setItem("token",e)},logout:function(){localStorage.removeItem("token")},getCurrentUser:function(){try{var e=localStorage.getItem("token");return Object(C.a)(e)}catch(t){return null}},getJwt:y},D=k.apiUrl+"/users";function j(e){return E.post(D,{email:e.email,password:e.password,name:e.name})}var O=a(13),N=(a(128),a(144)),U=a(211),B=a(197),L=a(209),P=a(194),T=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={email:"",name:"",password:"",rePassword:"",selectedTab:0,warning:""},e._apiUrl=k.api_url,e.clearAllFields=function(){e.setState({email:"",name:"",password:"",rePassword:"",warning:""})},e.validateEmail=function(){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e.state.email)?"":"Invalid email"},e.logInUser=function(){var t=Object(m.a)(u.a.mark((function t(a){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),n="",n=0===e.state.email.length?"Please enter an email id":e.validateEmail(),0===e.state.password.length&&(n+="\n Please enter your password"),0===n.length){t.next=7;break}return alert(n),t.abrupt("return");case 7:return t.prev=7,t.next=10,x.login(e.state);case 10:e.props.updateUser(),t.next=17;break;case 13:return t.prev=13,t.t0=t.catch(7),t.t0.response&&400===t.t0.response.status&&b.b.error(t.t0.response.data),t.abrupt("return");case 17:if(0===n.length){t.next=20;break}return alert(n),t.abrupt("return");case 20:e.props.history.push("/customers");case 21:case"end":return t.stop()}}),t,null,[[7,13]])})));return function(e){return t.apply(this,arguments)}}(),e.signUpUser=Object(m.a)(u.a.mark((function t(){var a,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a="",a=0===e.state.email.length?"Please enter an email id":e.validateEmail(),0===e.state.password.length?a+="\nPlease enter a password":e.state.password!==e.state.rePassword&&(a+="\nPasswords don't match"),0===a.trim().length){t.next=6;break}return alert(a),t.abrupt("return");case 6:return t.prev=6,t.next=9,j(e.state);case 9:n=t.sent,x.loginWithJwt(n.headers["x-auth-token"]),e.props.updateUser(),e.props.history.push("/customers"),t.next=19;break;case 15:return t.prev=15,t.t0=t.catch(6),t.t0.response&&400===t.t0.response.status&&b.b.error(t.t0.response.data),t.abrupt("return");case 19:0===a.length&&e.setState({selectedTab:0});case 20:case"end":return t.stop()}}),t,null,[[6,15]])}))),e.handleInputChange=function(t){e.setState(Object(c.a)({},t.target.name,t.target.value))},e.changeTab=function(t){e.setState({selectedTab:t}),e.clearAllFields()},e}return Object(p.a)(a,[{key:"matchPasswords",value:function(){if(this.state.password!==this.state.rePassword)return"passwords don't match"}},{key:"render",value:function(){var e=this;return x.getCurrentUser()?r.a.createElement(O.a,{to:"/customers"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,null),r.a.createElement("div",{className:"crmHome-main"},r.a.createElement("div",{className:"crmHome-title"},"Best CRM App"),r.a.createElement(N.a,{className:"paperForm"},r.a.createElement(L.a,{value:this.state.selectedTab,onChange:function(t,a){return e.changeTab(a)},"aria-label":"simple tabs example"},r.a.createElement(P.a,{label:"LOGIN"}),r.a.createElement(P.a,{label:"SIGN UP"})),r.a.createElement("div",{className:"loginView tabView",hidden:0!==this.state.selectedTab},r.a.createElement(U.a,{name:"email",id:"logIn-email",label:"email",variant:"outlined",onChange:this.handleInputChange,value:this.state.email}),r.a.createElement(U.a,{name:"password",id:"logIn-password",label:"password",variant:"outlined",type:"password",onChange:this.handleInputChange,value:this.state.password}),r.a.createElement(B.a,{color:"primary",variant:"contained",onClick:function(t){return e.logInUser(t)}},"log in")),r.a.createElement("div",{className:"signupView tabView",hidden:1!==this.state.selectedTab},r.a.createElement(U.a,{name:"name",id:"signup-name",label:"name",variant:"outlined",onChange:this.handleInputChange,value:this.state.name}),r.a.createElement(U.a,{name:"email",id:"signUp-email",label:"email",variant:"outlined",onChange:this.handleInputChange,value:this.state.email}),r.a.createElement(U.a,{name:"password",id:"signUp-password",label:"password",variant:"outlined",type:"password",onChange:this.handleInputChange,value:this.state.password}),r.a.createElement(U.a,{name:"rePassword",id:"signUp-rePassword",label:"password",variant:"outlined",type:"password",onChange:this.handleInputChange,value:this.state.rePassword}),r.a.createElement(B.a,{color:"primary",variant:"contained",onClick:function(){return e.signUpUser()}},"Sign Up")))))}}]),a}(r.a.Component),A=a(88),_=function(e){e.path;var t=e.component,a=e.render,n=Object(A.a)(e,["path","component","render"]);return r.a.createElement(O.b,Object.assign({exact:!0},n,{render:function(e){return x.getCurrentUser()?t?r.a.createElement(t,e):a(e):r.a.createElement(O.a,{to:{pathname:"/",state:{from:e.location}}})}}))},J=(a(135),a(205)),F=a(208),M=a(213),W=a(198),V=a(200),G=a(204),H=a(203),z=a(199),R=a(201),$=a(202),q=a(86),K=a.n(q),Q=Object(W.a)({table:{minWidth:650}});function X(e){var t=Q();return r.a.createElement(z.a,{component:N.a},r.a.createElement(V.a,{className:t.table,"aria-label":"simple table"},r.a.createElement(R.a,null,r.a.createElement($.a,null,r.a.createElement(H.a,null,"Customer ID"),r.a.createElement(H.a,{align:"right"},"Name"),r.a.createElement(H.a,{align:"right"},"Gender"),r.a.createElement(H.a,{align:"right"},"Contact No"),r.a.createElement(H.a,{align:"right"},"Remove?"))),r.a.createElement(G.a,null,e.tableData.map((function(t,a){return r.a.createElement($.a,{key:t.name},r.a.createElement(H.a,{component:"th",scope:"row"},t._id),r.a.createElement(H.a,{align:"right"},t.name),r.a.createElement(H.a,{align:"right"},t.gender),r.a.createElement(H.a,{align:"right"},t.contact),r.a.createElement(H.a,{align:"right"},e.deletingCustList.includes(t._id)?r.a.createElement("div",null,r.a.createElement(J.a,{color:"secondary"})):r.a.createElement(B.a,{variant:"contained",color:"secondary",className:"deleteBtn",startIcon:r.a.createElement(K.a,null),onClick:function(){e.deleteCustomerId(t._id,a)}})))})))))}var Y=a(212),Z=a(210),ee=k.apiUrl+"/customers";function te(e){return E.delete((t=e,"".concat(ee,"/").concat(t)));var t}var ae=a(140),ne=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={name:"",gender:"male",contact:"",fetchedData:"",tableData:[],deletingCustList:[],openSnackBar:!1,lastDeletedCustomer:{},showUndoIndicator:!1},n.errorBoolsList=[!1,!1],n.setErrorsList=function(e){console.log("errorList is:"+e),n.errorBoolsList=[].concat(e)},n.showSnackBar=function(){n.setState({openSnackBar:!0})},n.closeSnackBar=function(e,t){"clickaway"!==t&&n.setState({openSnackBar:!1})},n.createData=function(e,t,a,n){return{_id:e,name:t,gender:a,contact:n}},n.deleteCustomerId=function(){var e=Object(m.a)(u.a.mark((function e(t,a){var r,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r={}).data=n.state.tableData[a],r.index=a,n.setState({deletingCustList:n.state.deletingCustList.concat(t)}),console.log("deleting custID:"+t),e.next=7,te(t);case 7:s=e.sent,console.log("customer deleted, resp.data is ",s.data),n.setState({tableData:n.state.tableData.filter((function(e){return e._id!=t})),deletingCustList:n.state.deletingCustList.filter((function(e){return e!==t}))}),console.log("main list, deleting id list and last cust deleting list updated using setState, showing snackbar now"+t),n.showSnackBar();case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.validateData=function(){var e=[!1,!1],t=[];return 0===n.state.name.length&&(t.push("Customer Name can't be empty"),e[0]=!0),0===n.state.contact.length&&(t.push("Contact number can't be empty"),e[1]=!0),isNaN(n.state.contact)&&(t.push("Please enter valid mob number"),e[1]=!0),10!=="".concat(parseInt(n.state.contact)).length&&(t.push("Contact Number needs to be of 10 digit"),e[1]=!0),t.length>0&&alert(t.join("\n")),n.setErrorsList(e),n.setState(),0===t.length},n.handleInputChange=function(e){n.setState(Object(c.a)({},e.target.name,e.target.value))},n.genderList=["male","female","others","prefer not to say"],n.updateTableData=function(){var e=Object(m.a)(u.a.mark((function e(t,a,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("position in new function is: and element to be added is "+r,a),void 0===r?t.push(a):t.splice(r,0,a),n.setState({tableData:t||[],lastDeletedCustomer:{}});case 3:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),n.getCustomerIdAndSaveData=Object(m.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.validateData()){e.next=3;break}return n.setState({},(function(){return n.errorBoolsList})),e.abrupt("return",0);case 3:return n.setState({fetchedData:null}),new Map,e.next=7,r=ae.pick(n.state,["name","contact","gender"]),E.post(ee,r);case 7:return t=e.sent,console.log("response from server after adding another customer is ,",t),console.log(n.state),a=[].concat(n.state.tableData),e.next=13,n.updateTableData(a,n.createData(t.data._id,n.state.name,n.state.gender,n.state.contact));case 13:n.setState({customerName:"",gender:"Male",mobNo:"",fetchedData:""},(function(){return n.errorBoolsList}));case 14:case"end":return e.stop()}var r}),e)}))),n.fetchFormData=Object(m.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.get(ee);case 2:t=e.sent,a=t.data,n.setState({tableData:null!==a&&void 0!==a?a:[]});case 5:case"end":return e.stop()}}),e)}))),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){console.log("mounted"),this.fetchFormData(),console.log("data from local storage")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(N.a,{className:"paper"},r.a.createElement("form",null,r.a.createElement("div",null,r.a.createElement(U.a,{name:"name",id:"customerName",label:"Customer Name",variant:"outlined",onChange:this.handleInputChange,value:this.state.name,error:this.errorBoolsList[0]})),r.a.createElement("div",null,r.a.createElement(U.a,{name:"contact",id:"mobNo",label:"Contact No.",variant:"outlined",onChange:this.handleInputChange,value:this.state.contact,error:this.errorBoolsList[1]})),r.a.createElement("div",null,r.a.createElement(F.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",name:"gender",value:this.state.gender,onChange:this.handleInputChange,color:"secondary"},this.genderList.map((function(e){return r.a.createElement(M.a,{value:e},e)}))))),null===this.state.fetchedData?r.a.createElement("div",null,r.a.createElement(J.a,{color:"secondary"})):r.a.createElement("div",null,r.a.createElement(B.a,{color:"primary",variant:"contained",onClick:function(){return e.getCustomerIdAndSaveData()}},"Save info"),this.state.showUndoIndicator?r.a.createElement("div",null,r.a.createElement(J.a,{color:"secondary"})):"")),0!==this.state.tableData.length?r.a.createElement(X,{className:"simpleTable",tableData:this.state.tableData,deletingCustList:this.state.deletingCustList,deleteCustomerId:function(t,a){return e.deleteCustomerId(t,a)}}):"",r.a.createElement(Y.a,{open:this.state.openSnackBar,autoHideDuration:3e3,onClose:this.closeSnackBar},r.a.createElement(Z.a,{onClose:this.closeSnackBar,severity:"success"},"Customer Deleted!")))}}]),a}(r.a.Component);a(142);function re(){return Object(n.useEffect)((function(){localStorage.removeItem("token"),window.location="/"}),[]),null}var se=a(206),oe=a(207),le=function(e){var t=Object(O.g)();function a(){return(a=Object(m.a)(u.a.mark((function a(){return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:x.logout(),e.updateUser(),t.push("/");case 3:case"end":return a.stop()}}),a)})))).apply(this,arguments)}return r.a.createElement(se.a,{position:"static",className:"topAppBar"},r.a.createElement(oe.a,{className:"appBar-toolBar"},e.user?r.a.createElement(B.a,{color:"inherit",onClick:function(){return a.apply(this,arguments)}},"Logout"):""))};var ce=function(e){var t=Object(n.useState)({}),a=Object(l.a)(t,2),s=a[0],o=a[1],c=function(){var e=x.getCurrentUser();o(e)};return Object(n.useEffect)((function(){c()}),[]),r.a.createElement("div",{className:"App"},r.a.createElement(le,{user:s,updateUser:c}),r.a.createElement("header",{className:"App-header"},r.a.createElement(O.d,null,r.a.createElement(_,{exact:!0,path:"/customers",component:ne}),r.a.createElement(O.b,{exact:!0,path:"/",render:function(e){return r.a.createElement(T,Object.assign({},e,{updateUser:c}))}}),r.a.createElement(O.b,{path:"/logout",component:re}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ie=a(41);w.init(),o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ie.a,null,r.a.createElement(ce,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},30:function(e){e.exports=JSON.parse('{"api_url":"https://u39h9e73d2.execute-api.us-east-1.amazonaws.com/production/api","apiUrl":"https://u39h9e73d2.execute-api.us-east-1.amazonaws.com/production/api"}')}},[[100,1,2]]]);
//# sourceMappingURL=main.fe01bfce.chunk.js.map