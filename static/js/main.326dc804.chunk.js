(this.webpackJsonpforms=this.webpackJsonpforms||[]).push([[0],{136:function(e,t,a){e.exports=a(178)},141:function(e,t,a){},142:function(e,t,a){},163:function(e,t,a){},170:function(e,t,a){},178:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(13),o=a.n(s),l=(a(141),a(120)),c=(a(142),a(78)),i=a(22),u=a.n(i),m=a(30),d=a(79),p=a(80),h=a(87),g=a(86),f=a(54),v=a.n(f),b=a(62),w=a(244),E=a(26),C=a(119);var k={init:function(){w.a({dsn:"https://ce625a42c479474d86a00952b0109351@o504500.ingest.sentry.io/5591499",autoSessionTracking:!0,integrations:[new C.a.BrowserTracing],tracesSampleRate:1})},log:function(e){E.a(e)}};v.a.interceptors.response.use(null,(function(e){return e.response&&e.response.status>=400&&e.response.status<500||(k.log(e),console.log("some other unexp error",e),b.b.error("unexpected error occured")),Promise.reject(e)}));var S={get:v.a.get,post:v.a.post,put:v.a.put,delete:v.a.delete,setJwt:function(e){v.a.defaults.headers.common["x-auth-token"]=e}},I=a(114),y=a(42),x=y.apiUrl+"/auth";function D(){return(D=Object(m.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.post(x,{email:t.email,password:t.password});case 2:a=e.sent,n=a.data,localStorage.setItem("token",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(){return localStorage.getItem("token")}S.setJwt(j());var O={login:function(e){return D.apply(this,arguments)},loginWithJwt:function(e){localStorage.setItem("token",e)},logout:function(){localStorage.removeItem("token")},getCurrentUser:function(){try{var e=localStorage.getItem("token");return Object(I.a)(e)}catch(t){return null}},getJwt:j},N=y.apiUrl+"/users";function U(e){return S.post(N,{email:e.email,password:e.password,name:e.name})}var B=a(18),L=(a(163),a(179)),P=a(248),T=a(233),A=a(246),_=a(230),J=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={email:"",name:"",password:"",rePassword:"",selectedTab:0,warning:""},e._apiUrl=y.api_url,e.clearAllFields=function(){e.setState({email:"",name:"",password:"",rePassword:"",warning:""})},e.validateEmail=function(){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e.state.email)?"":"Invalid email"},e.logInUser=function(){var t=Object(m.a)(u.a.mark((function t(a){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),n="",n=0===e.state.email.length?"Please enter an email id":e.validateEmail(),0===e.state.password.length&&(n+="\n Please enter your password"),0===n.length){t.next=7;break}return alert(n),t.abrupt("return");case 7:return t.prev=7,t.next=10,O.login(e.state);case 10:e.props.updateUser(),t.next=17;break;case 13:return t.prev=13,t.t0=t.catch(7),t.t0.response&&400===t.t0.response.status&&b.b.error(t.t0.response.data),t.abrupt("return");case 17:if(0===n.length){t.next=20;break}return alert(n),t.abrupt("return");case 20:e.props.history.push("/customers");case 21:case"end":return t.stop()}}),t,null,[[7,13]])})));return function(e){return t.apply(this,arguments)}}(),e.signUpUser=Object(m.a)(u.a.mark((function t(){var a,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a="",a=0===e.state.email.length?"Please enter an email id":e.validateEmail(),0===e.state.password.length?a+="\nPlease enter a password":e.state.password!==e.state.rePassword&&(a+="\nPasswords don't match"),0===a.trim().length){t.next=6;break}return alert(a),t.abrupt("return");case 6:return t.prev=6,t.next=9,U(e.state);case 9:n=t.sent,O.loginWithJwt(n.headers["x-auth-token"]),e.props.updateUser(),e.props.history.push("/customers"),t.next=19;break;case 15:return t.prev=15,t.t0=t.catch(6),t.t0.response&&400===t.t0.response.status&&b.b.error(t.t0.response.data),t.abrupt("return");case 19:0===a.length&&e.setState({selectedTab:0});case 20:case"end":return t.stop()}}),t,null,[[6,15]])}))),e.handleInputChange=function(t){e.setState(Object(c.a)({},t.target.name,t.target.value))},e.changeTab=function(t){e.setState({selectedTab:t}),e.clearAllFields()},e}return Object(p.a)(a,[{key:"matchPasswords",value:function(){if(this.state.password!==this.state.rePassword)return"passwords don't match"}},{key:"render",value:function(){var e=this;return O.getCurrentUser()?r.a.createElement(B.a,{to:"/customers"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,null),r.a.createElement("div",{className:"crmHome-main"},r.a.createElement("div",{className:"crmHome-title"},"Best CRM App"),r.a.createElement(L.a,{className:"paperForm"},r.a.createElement(A.a,{value:this.state.selectedTab,onChange:function(t,a){return e.changeTab(a)},"aria-label":"simple tabs example"},r.a.createElement(_.a,{label:"LOGIN"}),r.a.createElement(_.a,{label:"SIGN UP"})),r.a.createElement("div",{className:"loginView tabView",hidden:0!==this.state.selectedTab},r.a.createElement(P.a,{name:"email",id:"logIn-email",label:"email",variant:"outlined",onChange:this.handleInputChange,value:this.state.email}),r.a.createElement(P.a,{name:"password",id:"logIn-password",label:"password",variant:"outlined",type:"password",onChange:this.handleInputChange,value:this.state.password}),r.a.createElement(T.a,{color:"primary",variant:"contained",onClick:function(t){return e.logInUser(t)}},"log in")),r.a.createElement("div",{className:"signupView tabView",hidden:1!==this.state.selectedTab},r.a.createElement(P.a,{name:"name",id:"signup-name",label:"name",variant:"outlined",onChange:this.handleInputChange,value:this.state.name}),r.a.createElement(P.a,{name:"email",id:"signUp-email",label:"email",variant:"outlined",onChange:this.handleInputChange,value:this.state.email}),r.a.createElement(P.a,{name:"password",id:"signUp-password",label:"password",variant:"outlined",type:"password",onChange:this.handleInputChange,value:this.state.password}),r.a.createElement(P.a,{name:"rePassword",id:"signUp-rePassword",label:"password",variant:"outlined",type:"password",onChange:this.handleInputChange,value:this.state.rePassword}),r.a.createElement(T.a,{color:"primary",variant:"contained",onClick:function(){return e.signUpUser()}},"Sign Up")))))}}]),a}(r.a.Component),F=a(121),M=function(e){e.path;var t=e.component,a=e.render,n=Object(F.a)(e,["path","component","render"]);return r.a.createElement(B.b,Object.assign({exact:!0},n,{render:function(e){return O.getCurrentUser()?t?r.a.createElement(t,e):a(e):r.a.createElement(B.a,{to:{pathname:"/",state:{from:e.location}}})}}))},W=(a(170),a(241)),V=a(245),G=a(250),H=a(234),R=a(236),z=a(240),$=a(239),q=a(235),K=a(237),Q=a(238),X=a(118),Y=a.n(X),Z=Object(H.a)({table:{minWidth:650}});function ee(e){var t=Z();return r.a.createElement(q.a,{component:L.a},r.a.createElement(R.a,{className:t.table,"aria-label":"simple table"},r.a.createElement(K.a,null,r.a.createElement(Q.a,null,r.a.createElement($.a,null,"Customer ID"),r.a.createElement($.a,{align:"right"},"Name"),r.a.createElement($.a,{align:"right"},"Gender"),r.a.createElement($.a,{align:"right"},"Contact No"),r.a.createElement($.a,{align:"right"},"Remove?"))),r.a.createElement(z.a,null,e.tableData.map((function(t,a){return r.a.createElement(Q.a,{key:t.name},r.a.createElement($.a,{component:"th",scope:"row"},t._id),r.a.createElement($.a,{align:"right"},t.name),r.a.createElement($.a,{align:"right"},t.gender),r.a.createElement($.a,{align:"right"},t.contact),r.a.createElement($.a,{align:"right"},e.deletingCustList.includes(t._id)?r.a.createElement("div",null,r.a.createElement(W.a,{color:"secondary"})):r.a.createElement(T.a,{variant:"contained",color:"secondary",className:"deleteBtn",startIcon:r.a.createElement(Y.a,null),onClick:function(){e.deleteCustomerId(t._id,a)}})))})))))}var te=a(249),ae=a(247),ne=y.apiUrl+"/customers";function re(e){return S.delete((t=e,"".concat(ne,"/").concat(t)));var t}var se=a(175),oe=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={name:"",gender:"male",contact:"",fetchedData:"",tableData:[],deletingCustList:[],openSnackBar:!1,lastDeletedCustomer:{},showUndoIndicator:!1},n.errorBoolsList=[!1,!1],n.setErrorsList=function(e){console.log("errorList is:"+e),n.errorBoolsList=[].concat(e)},n.showSnackBar=function(){n.setState({openSnackBar:!0})},n.closeSnackBar=function(e,t){"clickaway"!==t&&n.setState({openSnackBar:!1})},n.createData=function(e,t,a,n){return{_id:e,name:t,gender:a,contact:n}},n.deleteCustomerId=function(){var e=Object(m.a)(u.a.mark((function e(t,a){var r,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r={}).data=n.state.tableData[a],r.index=a,n.setState({deletingCustList:n.state.deletingCustList.concat(t)}),console.log("deleting custID:"+t),e.next=7,re(t);case 7:s=e.sent,console.log("customer deleted, resp.data is ",s.data),n.setState({tableData:n.state.tableData.filter((function(e){return e._id!==t})),deletingCustList:n.state.deletingCustList.filter((function(e){return e!==t}))}),console.log("main list, deleting id list and last cust deleting list updated using setState, showing snackbar now"+t),n.showSnackBar();case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.validateData=function(){var e=[!1,!1],t=[];return 0===n.state.name.length&&(t.push("Customer Name can't be empty"),e[0]=!0),0===n.state.contact.length&&(t.push("Contact number can't be empty"),e[1]=!0),isNaN(n.state.contact)&&(t.push("Please enter valid mob number"),e[1]=!0),10!=="".concat(parseInt(n.state.contact)).length&&(t.push("Contact Number needs to be of 10 digit"),e[1]=!0),t.length>0&&alert(t.join("\n")),n.setErrorsList(e),n.setState(),0===t.length},n.handleInputChange=function(e){n.setState(Object(c.a)({},e.target.name,e.target.value))},n.genderList=["male","female","others","prefer not to say"],n.updateTableData=function(){var e=Object(m.a)(u.a.mark((function e(t,a,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("position in new function is: and element to be added is "+r,a),void 0===r?t.push(a):t.splice(r,0,a),n.setState({tableData:t||[],lastDeletedCustomer:{}});case 3:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),n.getCustomerIdAndSaveData=Object(m.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.validateData()){e.next=3;break}return n.setState({},(function(){return n.errorBoolsList})),e.abrupt("return",0);case 3:return n.setState({fetchedData:null}),new Map,e.next=7,r=se.pick(n.state,["name","contact","gender"]),S.post(ne,r);case 7:return t=e.sent,console.log("response from server after adding another customer is ,",t),console.log(n.state),a=[].concat(n.state.tableData),e.next=13,n.updateTableData(a,n.createData(t.data._id,n.state.name,n.state.gender,n.state.contact));case 13:n.setState({customerName:"",gender:"Male",mobNo:"",fetchedData:""},(function(){return n.errorBoolsList}));case 14:case"end":return e.stop()}var r}),e)}))),n.fetchFormData=Object(m.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.get(ne);case 2:t=e.sent,a=t.data,n.setState({tableData:null!==a&&void 0!==a?a:[]});case 5:case"end":return e.stop()}}),e)}))),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){console.log("mounted"),this.fetchFormData(),console.log("data from local storage")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(L.a,{className:"paper"},r.a.createElement("form",null,r.a.createElement("div",null,r.a.createElement(P.a,{name:"name",id:"customerName",label:"Customer Name",variant:"outlined",onChange:this.handleInputChange,value:this.state.name,error:this.errorBoolsList[0]})),r.a.createElement("div",null,r.a.createElement(P.a,{name:"contact",id:"mobNo",label:"Contact No.",variant:"outlined",onChange:this.handleInputChange,value:this.state.contact,error:this.errorBoolsList[1]})),r.a.createElement("div",null,r.a.createElement(V.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",name:"gender",value:this.state.gender,onChange:this.handleInputChange,color:"secondary"},this.genderList.map((function(e){return r.a.createElement(G.a,{value:e},e)}))))),null===this.state.fetchedData?r.a.createElement("div",null,r.a.createElement(W.a,{color:"secondary"})):r.a.createElement("div",null,r.a.createElement(T.a,{color:"primary",variant:"contained",onClick:function(){return e.getCustomerIdAndSaveData()}},"Save info"),this.state.showUndoIndicator?r.a.createElement("div",null,r.a.createElement(W.a,{color:"secondary"})):"")),0!==this.state.tableData.length?r.a.createElement(ee,{className:"simpleTable",tableData:this.state.tableData,deletingCustList:this.state.deletingCustList,deleteCustomerId:function(t,a){return e.deleteCustomerId(t,a)}}):"",r.a.createElement(te.a,{open:this.state.openSnackBar,autoHideDuration:3e3,onClose:this.closeSnackBar},r.a.createElement(ae.a,{onClose:this.closeSnackBar,severity:"success"},"Customer Deleted!")))}}]),a}(r.a.Component);a(177);function le(){return Object(n.useEffect)((function(){localStorage.removeItem("token")}),[]),null}var ce=a(242),ie=a(243),ue=function(e){var t=Object(B.g)();function a(){return(a=Object(m.a)(u.a.mark((function a(){return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:O.logout(),e.updateUser(),t.push("/");case 3:case"end":return a.stop()}}),a)})))).apply(this,arguments)}return r.a.createElement(ce.a,{position:"static",className:"topAppBar"},r.a.createElement(ie.a,{className:"appBar-toolBar"},e.user?r.a.createElement(T.a,{color:"inherit",onClick:function(){return a.apply(this,arguments)}},"Logout"):""))};var me=function(e){var t=Object(n.useState)({}),a=Object(l.a)(t,2),s=a[0],o=a[1],c=function(){var e=O.getCurrentUser();o(e)};return Object(n.useEffect)((function(){c()}),[]),r.a.createElement("div",{className:"App"},r.a.createElement(ue,{user:s,updateUser:c}),r.a.createElement("header",{className:"App-header"},r.a.createElement(B.d,null,r.a.createElement(M,{exact:!0,path:"/customers",component:oe}),r.a.createElement(B.b,{path:"/",render:function(e){return r.a.createElement(J,Object.assign({},e,{updateUser:c}))}}),r.a.createElement(B.b,{path:"/logout",component:le}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var de=a(57);k.init(),o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(de.a,null,r.a.createElement(me,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},42:function(e){e.exports=JSON.parse('{"api_url":"https://u39h9e73d2.execute-api.us-east-1.amazonaws.com/production/api","apiUrl":"https://u39h9e73d2.execute-api.us-east-1.amazonaws.com/production/api"}')}},[[136,1,2]]]);
//# sourceMappingURL=main.326dc804.chunk.js.map