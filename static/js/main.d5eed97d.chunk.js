(this.webpackJsonpforms=this.webpackJsonpforms||[]).push([[0],{82:function(e,t,a){e.exports=a(99)},87:function(e,t,a){},88:function(e,t,a){},90:function(e,t,a){},94:function(e,t,a){},99:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(9),o=a.n(s),l=(a(87),a(88),a(7)),c=a(12),i=a.n(c),u=a(20),m=a(38),d=a(23),p=a(55),h=a(54),g=(a(90),a(139)),f=a(158),b=a(146),w=a(156),v=a(143),E=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(m.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={email:"",pswd:"",rePswd:"",selectedTab:0,warning:""},e.clearAllFields=function(){e.setState({email:"",pswd:"",rePswd:"",warning:""})},e.validateEmail=function(){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e.state.email)?"":"Invalid email"},e.logInUser=function(){var t=Object(u.a)(i.a.mark((function t(a){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),n="",n=0===e.state.email.length?"Please enter an email id":e.validateEmail(),0===e.state.pswd.length&&(n+="\n Please enter your password"),0===n.length){t.next=7;break}return alert(n),t.abrupt("return");case 7:return t.next=9,e.makePostRequest("http://localhost:5000/login",{email:e.state.email,pswd:e.state.pswd});case 9:if("noEmail"===(r=t.sent).result?n="Email id doesn't exist, please sign up first":"passwordError"===r.result?n="wrong password, please check your password":"loggedIn"===r.result&&e.props.history.push("/customers"),0===n.length){t.next=14;break}return alert(n),t.abrupt("return");case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.signUpUser=Object(u.a)(i.a.mark((function t(){var a,n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a="",a=0===e.state.email.length?"Please enter an email id":e.validateEmail(),0===e.state.pswd.length?a+="\nPlease enter a password":e.state.pswd!==e.state.rePswd&&(a+="\nPasswords don't match"),0===a.trim().length){t.next=6;break}return alert(a),t.abrupt("return");case 6:return(n=new Map).email=e.state.email,n.pswd=e.state.pswd,t.next=11,e.makePostRequest("http://localhost:5000/signup",n);case 11:if(r=t.sent,console.log("response of sign up post request"),console.log(r),"failed"===r.result&&(a="failed to sign up, please try again"),"duplicateEmail"===r.result&&(a="Email id already, exist, please use another email id  or reset password"),0===a.trim().length){t.next=19;break}return alert(a),t.abrupt("return");case 19:0===a.length&&e.setState({selectedTab:0});case 20:case"end":return t.stop()}}),t)}))),e.makePostRequest=function(){var e=Object(u.a)(i.a.mark((function e(t,a){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),e.handleInputChange=function(t){e.setState(Object(l.a)({},t.target.name,t.target.value))},e.changeTab=function(t){e.setState({selectedTab:t}),e.clearAllFields()},e}return Object(d.a)(a,[{key:"matchPasswords",value:function(){if(this.state.pswd!==this.state.rePswd)return"passwords don't match"}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"crmHome-main"},r.a.createElement("div",{className:"crmHome-title"},"Best CRM App"),r.a.createElement(g.a,{className:"paperForm"},r.a.createElement(w.a,{value:this.state.selectedTab,onChange:function(t,a){return e.changeTab(a)},"aria-label":"simple tabs example"},r.a.createElement(v.a,{label:"LOGIN"}),r.a.createElement(v.a,{label:"SIGN UP"})),r.a.createElement("div",{className:"loginView tabView",hidden:0!==this.state.selectedTab},r.a.createElement(f.a,{name:"email",id:"logIn-email",label:"email",variant:"outlined",onChange:this.handleInputChange,value:this.state.email}),r.a.createElement(f.a,{name:"pswd",id:"logIn-pswd",label:"password",variant:"outlined",type:"password",onChange:this.handleInputChange,value:this.state.pswd}),r.a.createElement(b.a,{color:"primary",variant:"contained",onClick:function(t){return e.logInUser(t)}},"log in")),r.a.createElement("div",{className:"signupView tabView",hidden:1!==this.state.selectedTab},r.a.createElement(f.a,{name:"email",id:"signUp-email",label:"email",variant:"outlined",onChange:this.handleInputChange,value:this.state.email}),r.a.createElement(f.a,{name:"pswd",id:"signUp-pswd",label:"password",variant:"outlined",type:"password",onChange:this.handleInputChange,value:this.state.pswd}),r.a.createElement(f.a,{name:"rePswd",id:"signUpRe-pswd",label:"password",variant:"outlined",type:"password",onChange:this.handleInputChange,value:this.state.rePswd}),r.a.createElement(b.a,{color:"primary",variant:"contained",onClick:function(){return e.signUpUser()}},"Sign Up"))))}}]),a}(r.a.Component),C=a(68),k=a(32),D=(a(94),a(154)),I=a(155),y=a(161),N=a(147),S=a(149),x=a(153),O=a(152),j=a(148),P=a(150),B=a(151),L=a(67),T=a.n(L),U=Object(N.a)({table:{minWidth:650}});function R(e){var t=U();return r.a.createElement(j.a,{component:g.a},r.a.createElement(S.a,{className:t.table,"aria-label":"simple table"},r.a.createElement(P.a,null,r.a.createElement(B.a,null,r.a.createElement(O.a,null,"Customer ID"),r.a.createElement(O.a,{align:"right"},"Name"),r.a.createElement(O.a,{align:"right"},"Gender"),r.a.createElement(O.a,{align:"right"},"Contact No"),r.a.createElement(O.a,{align:"right"},"Remove?"))),r.a.createElement(x.a,null,e.tableData.map((function(t){return r.a.createElement(B.a,{key:t.name},r.a.createElement(O.a,{component:"th",scope:"row"},t._id),r.a.createElement(O.a,{align:"right"},t.name),r.a.createElement(O.a,{align:"right"},t.gender),r.a.createElement(O.a,{align:"right"},t.contact),r.a.createElement(O.a,{align:"right"},e.deletingCustList.includes(t._id)?r.a.createElement("div",null,r.a.createElement(D.a,{color:"secondary"})):r.a.createElement(b.a,{variant:"contained",color:"secondary",className:"deleteBtn",startIcon:r.a.createElement(T.a,null),onClick:function(){e.deleteCustomerId(t._id)}})))})))))}var M=a(160),q=a(157),A=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={customerName:"",gender:"Male",mobNo:"",fetchedData:"",tableData:[],deletingCustList:[],openSnackBar:!1,lastDeletedCustomer:[],showUndoIndicator:!1},n.errorBoolsList=[!1,!1],n.setErrorsList=function(e){console.log("errorList is:"+e),n.errorBoolsList=[].concat(e)},n.showSnackBar=function(){n.setState({openSnackBar:!0})},n.closeSnackBar=function(e,t){"clickaway"!==t&&n.setState({openSnackBar:!1})},n.createData=function(e,t,a,n){return{customerID:e,name:t,gender:a,contact:n}},n.deleteCustomerId=function(){var e=Object(u.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({deletingCustList:n.state.deletingCustList.concat(t)}),console.log("deleting custID:"+t),e.next=4,n.makePostRequest("http://localhost:5000/deleteCustomer",{customerID:t});case 4:e.sent,a=t,console.log("deleting custID from network, now updating local variables:"+t),n.setState({lastDeletedCustomer:a,tableData:n.state.tableData.filter((function(e){return e._id!=t})),deletingCustList:n.state.deletingCustList.filter((function(e){return e!==t}))}),console.log("main list, deleting id list and last cust deleting list updated using setState, showing snackbar now"+t),n.showSnackBar();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.validateData=function(){var e=[!1,!1],t=[];return 0===n.state.customerName.length&&(t.push("Customer Name can't be empty"),e[0]=!0),0===n.state.mobNo.length&&(t.push("Contact number can't be empty"),e[1]=!0),isNaN(n.state.mobNo)&&(t.push("Please enter valid mob number"),e[1]=!0),10!=="".concat(parseInt(n.state.mobNo)).length&&(t.push("Contact Number needs to be of 10 digit"),e[1]=!0),t.length>0&&alert(t.join("\n")),n.setErrorsList(e),n.setState(),0===t.length},n.handleInputChange=function(e){n.setState(Object(l.a)({},e.target.name,e.target.value))},n.genderList=["Male","Female","Rather Not Say","Others"],n.undoDelete=Object(u.a)(i.a.mark((function e(){var t,a,r,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.closeSnackBar(),n.setState({showUndoIndicator:!0}),(t=new Map).customerID=n.state.lastDeletedCustomer,e.next=6,n.makePostRequest("http://localhost:5000/undoDelete",t);case 6:return a=e.sent,console.log("res from undo"+JSON.stringify(a)),r=[].concat(n.state.tableData),s=(s=[].concat(n.state.deletingCustList)).filter((function(e){return a.deletedCustomer.customerID!==e})),n.setState({custIdBeingDeleted:s}),e.next=14,n.updateTableData(r,a.deletedCustomer,a.deletedCustomerIndex);case 14:n.setState({showUndoIndicator:!1});case 15:case"end":return e.stop()}}),e)}))),n.updateTableData=function(){var e=Object(u.a)(i.a.mark((function e(t,a,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("position in new function is:"+r),void 0===r?t.push(a):t.splice(r,0,a),n.setState({tableData:t,lastDeletedCustomer:[]});case 3:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),n.getCustomerId=Object(u.a)(i.a.mark((function e(){var t,a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.validateData()){e.next=3;break}return n.setState({},(function(){return n.errorBoolsList})),e.abrupt("return",0);case 3:return n.setState({fetchedData:null}),(t=new Map).name=n.state.customerName,t.gender=n.state.gender,t.contact=n.state.mobNo,e.next=10,n.makePostRequest("http://localhost:5000/",t);case 10:return a=e.sent,n.setState({fetchedData:a.customerID}),console.log(n.state),console.log("fetched CustomerID is: "+a.customerID),r=[].concat(n.state.tableData),e.next=17,n.updateTableData(r,n.createData(a.customerID,n.state.customerName,n.state.gender,n.state.mobNo));case 17:n.setState({customerName:"",gender:"Male",mobNo:"",fetchedData:""},(function(){return n.errorBoolsList}));case 18:case"end":return e.stop()}}),e)}))),n.makePostRequest=function(){var e=Object(u.a)(i.a.mark((function e(t,a){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.fetchFormData=Object(u.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:5000/customers",{credentials:"include"});case 2:return 403===(t=e.sent).status&&(alert("You need to login to view this page"),n.props.history.push("/"),console.log("gone to home page")),e.next=6,t.json();case 6:a=e.sent,n.setState({tableData:null!==a&&void 0!==a?a:[]});case 8:case"end":return e.stop()}}),e)}))),n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){console.log("mounted"),this.fetchFormData(),console.log("data from local storage")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(g.a,{className:"paper"},r.a.createElement("form",null,r.a.createElement("div",null,r.a.createElement(f.a,{name:"customerName",id:"customerName",label:"Customer Name",variant:"outlined",onChange:this.handleInputChange,value:this.state.customerName,error:this.errorBoolsList[0]})),r.a.createElement("div",null,r.a.createElement(f.a,{name:"mobNo",id:"mobNo",label:"Contact No.",variant:"outlined",onChange:this.handleInputChange,value:this.state.mobNo,error:this.errorBoolsList[1]})),r.a.createElement("div",null,r.a.createElement(I.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",name:"gender",value:this.state.gender,onChange:this.handleInputChange,color:"secondary"},this.genderList.map((function(e){return r.a.createElement(y.a,{value:e},e)}))))),null===this.state.fetchedData?r.a.createElement("div",null,r.a.createElement(D.a,{color:"secondary"})):r.a.createElement("div",null,r.a.createElement(b.a,{color:"primary",variant:"contained",onClick:function(){return e.getCustomerId()}},"Save info"),this.state.showUndoIndicator?r.a.createElement("div",null,r.a.createElement(D.a,{color:"secondary"})):"")),0!==this.state.tableData.length?r.a.createElement(R,{className:"simpleTable",tableData:this.state.tableData,deletingCustList:this.state.deletingCustList,deleteCustomerId:function(t){return e.deleteCustomerId(t)}}):"",r.a.createElement(M.a,{open:this.state.openSnackBar,autoHideDuration:3e3,onClose:this.closeSnackBar},r.a.createElement(q.a,{onClose:this.closeSnackBar,severity:"success",action:r.a.createElement(b.a,{color:"inherit",size:"small",onClick:this.undoDelete},"Undo")},"Customer Deleted!")))}}]),a}(r.a.Component);var F=function(){return r.a.createElement(C.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(k.c,null,r.a.createElement(k.a,{exact:!0,path:"/customers",component:A}),r.a.createElement(k.a,{path:"/",component:E})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[82,1,2]]]);
//# sourceMappingURL=main.d5eed97d.chunk.js.map